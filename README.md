# Тестовое задание SellerX

# Cодержание

# Описание задачи

Необходимо реализовать микросервис для работы с балансом пользователей (зачисление средств, списание средств, перевод средств от пользователя к пользователю, а также метод получения баланса пользователя). Сервис должен предоставлять HTTP API и принимать/отдавать запросы/ответы в формате JSON.

**Основное задание (минимум):**

Метод начисления средств на баланс. Принимает id пользователя и сколько средств зачислить.
Метод списания средств с баланса. Принимает id пользователя и сколько средств списать.
Метод перевода средств от пользователя к пользователю. Принимает id пользователя с которого нужно списать средства, id пользователя которому должны зачислить средства, а также сумму.
Метод получения текущего баланса пользователя. Принимает id пользователя. Баланс всегда в рублях.

**Дополнительные задания:**

Добавить к методу получения баланса доп. параметр. Пример: ?currency=USD. Если этот параметр присутствует, то мы должны конвертировать баланс пользователя с рубля на указанную валюту.

Необходимо предоставить метод получения списка транзакций с комментариями откуда и зачем были начислены/списаны средства с баланса. Необходимо предусмотреть пагинацию и сортировку по сумме и дате.

# Реализация

- Для создания REST API сервера использована стандартная библиотека [http/net](https://pkg.go.dev/net/http)
- Для работы с Postges использована стандартная библиотека [database/sql](https://pkg.go.dev/database/sql) и драйвер [lib/pq](https://pkg.go.dev/github.com/lib/pq), с написанием SQL запросов
- Для конфига - [BurntSushi/toml](github.com/BurntSushi/toml)
- Запуск через docker-compose
```
.
├── internal
├────── app
│       ├── model       // основные структуры
│       ├── apiserver   // обработчики запросов
│       ├── store       // взаимодействие с БД и бизнес-логика...
├── cmd             // точка входа в приложение
├── migrations      // SQL файлы с миграциями
├── configs         // файлы конфигурации
```

# Endpoints

- GET /api/v2/wallet/{user_id} - получить баланс пользователя
  - Параметры запросы:
    - user_id - идентификатор пользователя (необходим)
    - currency - 3х буквенное название валты для конвертации
- POST /api/v2/wallet/topup - пополнить баланс пользователя
  - Тело запроса:
    - user_id - идентификатор пользователя (необходим)
    - amount - сумма зачисления (необходима)
- POST /api/v2/wallet/writeoff - списать средства с баланса пользователя
  - Тело запроса:
    - user_id - идентификатор пользователя (необходим)
    - amount - сумма списания (необходима)
- POST /api/v2/wallet/transfer - перевод между пользователями
  - Тело запроса:
    - sender_id - идентификатор отправителя (необходим)
    - destination_id - идентификатор получателя (необходим)
    - amount - сумма перевода (необходима)
- GET /api/v2/wallet/{user_id}/transactions - получить баланс пользователя
  - Параметры запросы:
    - user_id - идентификатор пользователя (необходим)
    - sort - поля для сортировки через запятую
    - page - текущая страница
    - offset - количество элементов на страницу

